<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>reveal-md</title>
    <link rel="stylesheet" href="./css/reveal.css" />
    <link rel="stylesheet" href="./_assets/style.css" id="theme" />
    <link rel="stylesheet" href="./css/highlight/github.css" />
    <link rel="stylesheet" href="./css/print/paper.css" type="text/css" media="print" />

  </head>
  <body>
    <div class="reveal">
      <div class="slides"><section  data-markdown><script type="text/template">

<!-- .slide: data-background="./images/types.jpg" -->
<div class="highlighter">
<h1 class="title dark-background">Hint, Hint, Font Loading Matters!</h1>
<h2 class="subtitle" style="color:#c1ad9a;">Sia Karamalegos</h2>
</div>

</script></section><section  data-markdown><script type="text/template">
## hi, i'm sia

⚡ 👩🏻‍💻 🇬🇷 🐶 🐺 🎨 📓 ✈️

<img src="./images/sia.gif" alt="Sia at Mardi Gras" height="450px" style="border:none;">
</script></section><section  data-markdown><script type="text/template"><!-- TODO: change -->
## [bit.ly/perf-90](http://bit.ly/perf-90)
</script></section><section  data-markdown><script type="text/template">
<!-- .slide: data-background="./images/dog-wave.jpg" -->
<h1 class="dark-background">
  <span class="highlighter">Poll</span>
</h1>
<aside class="notes"><p>Poll - raise hand if (1) Passionate about perf and all the technical details. (2) Think perf is important but still very much learning. (3) Curious but not convinced. (4) Why are the rest of you here??</p>
</aside></script></section><section ><section data-markdown><script type="text/template">
# Why Should I Care?

</script></section><section data-markdown><script type="text/template">

> Pinterest reduced load times by 40% and saw a 15% increase in sign ups.

<small>https://wpostats.com/</small>

</script></section><section data-markdown><script type="text/template">

> Starbucks implemented a 2x faster time to interactive resulting in a 65% increase in rewards registrations.

<small>[Chrome Dev Summit 2018](https://www.youtube.com/watch?v=Xryhxi45Q5M&t=1113s&index=6&list=PLNYkxOF6rcIDjlCx1PcphPpmf43aKOAdF )</small>

</script></section><section data-markdown><script type="text/template">

> AliExpress reduced load by 36% and saw a 10.5% increase in orders.

<small>https://wpostats.com/</small>

</script></section><section data-markdown><script type="text/template">

> Speed is now used as a ranking factor for mobile searches.

<small>https://developers.google.com/web/updates/2018/07/search-ads-speed</small>

<aside class="notes"><p>In 2016, Doubleclick by Google released a report saying that 53% of mobile sites are abandoned if pages take longer than 3 seconds to load.</p>
</aside></script></section><section data-markdown><script type="text/template">

<img src="./images/shame.png" alt="Message on slower sites to users saying 'Usually loads slow'" height="500px" style="border:none;box-shadow:none;">

<small>[Moving towards a faster web](https://blog.chromium.org/2019/11/moving-towards-faster-web.html)</small>

</script></section><section data-markdown><script type="text/template">

The internet consumes 416.2 TWh of electricity per year. A 10% savings would be equivalent to:

- 6.2 million fewer cars on the road 🚗 <!-- .element: class="fragment fade-in-then-semi-out" -->
- 32 billion less pounds of coal being burned 💨 <!-- .element: class="fragment fade-in-then-semi-out" -->
- 486 million tree seedlings grown for 10 years 🌳 <!-- .element: class="fragment fade-in-then-semi-out" -->

<small>[How is your website impacting the planet?](https://www.websitecarbon.com/), [Greenhouse Gas Equivalencies Calculator](https://www.epa.gov/energy/greenhouse-gas-equivalencies-calculator)</small>

<aside class="notes"><p>Most of the energy is consumed by the network and data center, not users&#39; devices.</p>
</aside></script></section></section><section  data-markdown><script type="text/template">
<!-- .slide: data-background="./images/AA-font.jpg" -->

<div style="background-color:rgba(255,255,255,0.75);padding:20px;">

> Typography is what language looks like.

<small>—Ellen Lupton, Thinking with Type</small>

</div>
</script></section><section  data-markdown><script type="text/template">
<img class="nooutline" width="50%" src="./images/hello1.png" alt="hello in a large slab font" />

<small>[When Typography Speaks Louder Than Words](https://www.smashingmagazine.com/2012/04/when-typography-speaks-louder-than-words/)</small>
</script></section><section  data-markdown><script type="text/template">
<img class="nooutline" width="50%" src="./images/hello2.png" alt="hello in a small caps italic font" />

<small>[When Typography Speaks Louder Than Words](https://www.smashingmagazine.com/2012/04/when-typography-speaks-louder-than-words/)</small>
</script></section><section  data-markdown><script type="text/template">
<img class="nooutline" width="50%" src="./images/ny-fonts.jpg" alt="hello in a small caps italic font" />
</script></section><section  data-markdown><script type="text/template">
<!-- .slide: data-background="./images/frustration.jpg" -->
<h1 class="dark-background">
  <span class="highlighter">What annoys you about fonts?</span>
</h1>
</script></section><section  data-markdown><script type="text/template">
# Case study: Web Fonts

<img class="nooutline" width="50%" src="./images/fonts.png" alt="Screenshot of a Google fonts font option" />
</script></section><section  data-markdown><script type="text/template">
## Web Fonts

<ul class="plus-minus">
  <li class="plus fragment fade-in-then-semi-out">Hosted on fast and reliable CDNs</li>
  <li class="plus fragment fade-in-then-semi-out">Can provide optimized variants based on user's browser</li>
   <li class="plus fragment fade-in-then-semi-out">Opportunity for shared caching on popular fonts</li>
  <li class="plus fragment fade-in-then-semi-out">We now have control over FOUT and FOIT!</li>
  <li class="minus fragment fade-in-then-semi-out">Minumum of 2 separate requests</li>
  <li class="minus fragment fade-in-then-semi-out">Can't use resource hints on the font file</li>
  <li class="minus fragment fade-in-then-semi-out">Doesn't take advantage of HTTP2 multiplexing</li>
</ul>
</script></section><section  data-markdown><script type="text/template">
<img class="nooutline" src="./images/fonts-css.png" alt="Google fonts load waterfall showing wasted time from loading from css">

<small>[WebPageTest waterfall](http://webpagetest.org/customWaterfall.php?test=190406_EP_2dc139e2f92f617a2ec5f39624d6c8ca&run=2&width=930)</small>

<aside class="notes"><p>pause here and ask what else seems wasteful - calling from css and connection time to 2nd domain</p>
</aside></script></section><section  data-markdown><script type="text/template">
## Loading Google Fonts from CSS

```css
@import url('https://fonts.googleapis.com/css?family=Open+Sans:400,700');
```

<img class="nooutline" src="./images/webfonts_css.png" alt="Google fonts load waterfall showing wasted time from loading from css">

<small>[WebPageTest waterfall](http://webpagetest.org/customWaterfall.php?test=190406_EP_2dc139e2f92f617a2ec5f39624d6c8ca&run=2&width=930)</small>

<aside class="notes"><p>pause here and ask what else seems wasteful - the connection time to fonts.gstatic.com</p>
</aside></script></section><section  data-markdown><script type="text/template">
## Loading Google Fonts from HTML

```html
<link href="https://fonts.googleapis.com/css?family=Muli:400"
      rel="stylesheet">
```

<img class="nooutline" src="./images/fonts-html.png" alt="Google fonts load waterfall showing wasted time from loading from css">
</script></section><section  data-markdown><script type="text/template">
## Loading Google Fonts from HTML

```html
<link href="https://fonts.googleapis.com/css?family=Muli:400"
      rel="stylesheet">
```

<img class="nooutline" src="./images/fonts-html-annotated.png" alt="Google fonts load waterfall showing wasted time from loading from extra connection time">
</script></section><section  data-markdown><script type="text/template">
<img src="./images/resource-hints.jpg_large" alt="Resource hints cheatsheet find pdf at https://storage.googleapis.com/resource-hints/resource-hints-cheatsheet.pdf" />

<small>https://twitter.com/addyosmani/status/743571393174872064?lang=en</small>

<aside class="notes"><p>dns-prefetch only does the dns part of the prefetch, but on the plus side, it doesn&#39;t expire after a short amount of time.</p>
</aside></script></section><section  data-markdown><script type="text/template">
## Loading Google Fonts with preconnect to fonts.gstatic.com

```html
<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
<link href="https://fonts.googleapis.com/css?family=Muli:400"
      rel="stylesheet">
```

<img class="nooutline" src="./images/preconnect.png" alt="Google fonts load waterfall showing preconnect">
</script></section><section  data-markdown><script type="text/template">
<!-- .slide: data-background="./images/greek-types.jpg" -->

<div style="background-color:rgba(255,255,255,0.75);padding:20px;">

# Case Study: <br>Self-Hosted Fonts

</div>
</script></section><section  data-markdown><script type="text/template">
```html
<link as="font" type="font/woff2"
  href="./fonts/muli-v12-latin-regular.woff2" crossorigin>

<link as="font" type="font/woff2"
  href="./fonts/muli-v12-latin-700.woff2" crossorigin>
```

<img class="nooutline" src="./images/fonts-local.png" alt="Google fonts load waterfall showing local font waiting to load until after CSS">

<small>[WebPageTest waterfall](http://webpagetest.org/customWaterfall.php?test=190406_S0_0a529e9ce6086cbea8e3aadc942ddbf6&run=2&width=930)</small>
</script></section><section  data-markdown><script type="text/template">
```html
<link as="font" type="font/woff2"
  href="./fonts/muli-v12-latin-regular.woff2" crossorigin>

<link as="font" type="font/woff2"
  href="./fonts/muli-v12-latin-700.woff2" crossorigin>
```

<img class="nooutline" src="./images/no-preload.png" alt="Google fonts load waterfall showing local font waiting to load until after CSS">
</script></section><section  data-markdown><script type="text/template">
## Preload self-hosted fonts*

```html
<link rel="preload" as="font" type="font/woff2"
  href="./fonts/muli-v12-latin-regular.woff2" crossorigin>

<link rel="preload" as="font" type="font/woff2"
  href="./fonts/muli-v12-latin-700.woff2" crossorigin>
```

<img src="./images/font_preload.png" alt="Self-hosted waterfall showing preload">

<small>* Note that `preload` loads a resource whether used or not. Only preload resources that are needed on a particular page.</small>

<aside class="notes"><p><code>rel=&quot;preload&quot;</code> tells the browser to declaratively fetch the resource but not “execute” it (our CSS will queue usage). <code>as=&quot;font&quot;</code> tells the browser what it will be downloading so that it can set an appropriate priority. Without it, the browser would set a default low priority. <code>type=&quot;font/woff2</code> tells the browser the file type so that it only downloads the resource if it supports that file type. <code>crossorigin</code> is required because fonts are fetched using anonymous mode CORS.</p>
</aside></script></section><section  data-markdown><script type="text/template">
<img src="./images/caniuse-preload.png" alt="caniuse coverage report for link rel=preload">

<small>[caniuse](https://caniuse.com/#feat=link-rel-preload)</small>
</script></section><section  data-markdown><script type="text/template">
## [Shared Cache is Going Away](https://www.jefftk.com/p/shared-cache-is-going-away)

<small>[Chrome](https://www.chromestatus.com/feature/5730772021411840), [Firefox](https://bugzilla.mozilla.org/show_bug.cgi?id=1536058), [Safari](https://bugs.webkit.org/show_bug.cgi?id=110269)</small>
</script></section><section  data-markdown><script type="text/template">
<!-- .slide: data-background="./images/no.jpg" -->

<div style="background-color:rgba(255,255,255,0.75);padding:20px;">

# UX: Font Rendering

</div>
</script></section><section  data-markdown><script type="text/template">
## FOIT

<img src="./images/FOIT.png" alt="FOIT in action — note the missing navbar text in the filmstrip screenshot (throttled to slow 3G)">

<aside class="notes"><p>FOIT in action — note the missing navbar text in the filmstrip screenshot (throttled to slow 3G)</p>
</aside></script></section><section  data-markdown><script type="text/template">
## `font-display`

<img src="./images/font-display.png" alt="comparison of different font-display values" width="80%">

<small>https://font-display.glitch.me/</small>

<aside class="notes"><p>add the <code>font-display</code> property to the <code>@font-face</code> declaration</p>
</aside></script></section><section  data-markdown><script type="text/template">
<img src="./images/googlefonts-fontdisplay.png" class="nooutline" alt="Shipped! @GoogleFonts now let's you control web font loading using `font-display`. Say hello to the `display` parameter " width="55%">


<small>https://twitter.com/addyosmani/status/1128548064287952896/</small>
</script></section><section  data-markdown><script type="text/template">
## FOUT

<video autoplay loop>
  <source src="./images/fout.mp4" type="video/mp4">
  Oops, video not supported
</video>
</script></section><section  data-markdown><script type="text/template">
> “The style doesn’t matter so much, it’s that it has to flow the same way.”

— Tim Brown, Twitter
</script></section><section  data-markdown><script type="text/template">

## Font Style-Matcher by Monica Dinculescu

[meowni.ca/font-style-matcher/](https://meowni.ca/font-style-matcher/)
</script></section><section  data-markdown><script type="text/template">
<!-- .slide: data-background="./images/typography-collage.jpg" -->

<h1 class="dark-background highlighter">Variable Fonts</h1>
</script></section><section  data-markdown><script type="text/template">
## More resources mentioned

- [Making Google Fonts Faster⚡](https://sia.codes/posts/making-google-fonts-faster/) - includes how do download and host locally
- [Google Analytics + caniuse = *MAGIC*](https://sia.codes/posts/google-analytics-caniuse-magic/) - how to import your Google Analytics data into caniuse
- [subfont](https://github.com/Munter/subfont)
</script></section><section  data-markdown><script type="text/template">
<!-- .slide: data-background="./images/baggage_claim.jpg" -->
<h1 class="dark-background">
  <span class="highlighter">Houston's Baggage Claim Complaints</span>
</h1>

<small>http://www.nytimes.com/2012/08/19/opinion/sunday/why-waiting-in-line-is-torture.html</small>

<aside class="notes"><p>“Often the psychology of queuing is more important than the statistics of the wait itself,” notes the M.I.T. operations researcher Richard Larson. Occupied time (walking to baggage claim) feels shorter than unoccupied time (standing at the carousel).</p>
</aside></script></section><section  data-markdown><script type="text/template">
> Are you better off making the site load faster or ensuring that users complete their tasks?

<small>Christine Perfetti, [The Truth About Download Time](https://articles.uie.com/download_time/) 2006</small>
</script></section><section  data-markdown><script type="text/template">
<!-- .slide: data-background="./images/types.jpg" -->

<div style="background-color:rgba(255,255,255,0.75);padding:20px;">

# Thanks!
Writing, resources, and more at [sia.codes](https://sia.codes/)

</div></script></section></div>
    </div>

    <script src="./js/reveal.js"></script>

    <script>
      function extend() {
        var target = {};
        for (var i = 0; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (source.hasOwnProperty(key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      }

      // Optional libraries used to extend on reveal.js
      var deps = [
        { src: './plugin/markdown/marked.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
        { src: './plugin/markdown/markdown.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
        { src: './plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
        { src: './plugin/zoom-js/zoom.js', async: true },
        { src: './plugin/notes/notes.js', async: true },
        { src: './plugin/math/math.js', async: true }
      ];

      // default options to init reveal.js
      var defaultOptions = {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'default', // none/fade/slide/convex/concave/zoom
        dependencies: deps
      };

      // options from URL query string
      var queryOptions = Reveal.getQueryHash() || {};

      var options = extend(defaultOptions, {}, queryOptions);
    </script>


    <script>
      Reveal.initialize(options);
    </script>
  </body>
</html>
